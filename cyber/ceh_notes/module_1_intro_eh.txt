--[ INTRODUCTION TO ETHICAL HACKING

--[ Information Security Overview
 |- Protection of information and information systems
 |- Elements of information security:
  - Confidenciality, Intergrity, Availability, Authenticity and Non-repudation
 |- Reasons for information Security attacks
  - attacks = Motives (Goals) + Method + Vulnerability
  - Distrupt services, theft, data manipulation, cause fear and panic etc.
 |- Classification of Attacks:
  - Passive, active, close-in, insider and distribution
 |- Information warfare is the use of ICT to gain competitive advantage.
   - Defensive warfare: strategies used to defend attacks on ICT assets.
   - Offensive warfare: involves attacks against ICT assets.

--[ Cyber Kill Chain Concepts
 |- Intelligence-driven defense for Identification and prevention of malicious
    intrusion activities.
 |- Provides greater insights into attack phases
 |- Stages of Cyber kill Chain
   - Reconnaissance: 
   - Weaponization
   - Delivery
   - Exploitation
   - Install Malware
   - Command & Control (C2) operation
   - Actions on Objectives (Goals)
 | Tactics, Techniques, and Procedures (TTPs)
  - Tactics
  - Techniques
  - Procedures
 | Adversary Behavioral Identification
  - Internal reconnaissance
  - Use of power shell, command line interface, web shell
  - HTTP user-agent
  - Unspecified proxy activities
  - Command and control
  - DNS Tunneling
  - Data Staging
 | Indicators of Compromise (IoCs)
  - Pieces of forensic data, artifacts or clues that signifies malicious
    intrusion
  - In a network or operating system, information of suspicious activities
    gathered in a network establishment.
  - the atomic, computed or behavioral indicators of malicious intrusion.
  - Can be useful source of forensic evidence.
 | Categories of IoCs
  - Email Indicators
  - Network Indicators
  - Host-based Indicators
  - Behavioral Indicators

--[ Hacking Concepts
 |- Hacking: Exploiting system vulnerabilities and bypassing security
    controls.
 - Gaining unauthorized access to an IS or resources on an IS.
 - Involves modification of systems or application features to attain a goal
 - Not originally by definition of the system or application.
 - The effect of unethical hacking can lead to bad consequencies
 - To a system or an organization

 - Motives Behind hacking are diverse; some include
 - Theft, distrupt services, gain more knowledge, recognition, curiosity
 - and many others depending on the attacker goal.

 + Hacker: creative individual with excellent skills in computer
 - create and explore software and hardware and even with the ability to
 - discover vulnerabilities in a system.
 - Some hack as a hobby whiles others hack for malicious intentions.
 - Hacking can be used for good or malicious purpose.
 
 + Hacker Classes
 - Black Hat
 - White Hat
 - Grey Hat
 - Script Kiddies
 - Suicide Hackers
 - Cyber Terrorists
 - Hacktivists
 - State-Sponsored Hackers

 + Hacking Phases
 |- Reconnaissance: Preparatory stage when an attacker gathers info about the
   the target. Range may include target org-clients, network, systems etc.
   There are 2 types of Recon: Passive Recon & Active Recon
   Passive recon: No direct interaction with the target.
   Active recon: Involves directly interaction with the target

 |- Scanning: Active probing of target before attacking. Scanning the network
   for specific information (Pre-Atttack Phase).
   Port Scanner: Network mappers, Port scanner, ping tools, vulnerability
   scanners. Information extracted from this stage is used to launch attack.

 |- Gaining Access: Obtaining access to the target network, OS or application
   Access can be OS, Application or Network Level and can escalate privileges
   to obtain complete control.
   Password cracking , DDoS, Buffer Overflow, Session Hijacking are some
   the ways of taken control of target system.

 |- Maintaining Access: Retaining ownership of compromised system. Securing
   exclusive access with Backdoors, rootkits and trojans. Allows download,
   manipulation of data/application/configuration of the system.
   And a launch point for further attacks.

 |- Clearing Tracks: Activities carried out by an attacker on compromised
   system to hide malicious acts, maintain access, avoid detection and
   deleting/overriding evidence such as system, server, application logs to
   avoid suspicions.
   Attackers/Hackers always cover their tracks.

--[ Ethical Hacking Concepts
  + Ethical Hacking
  - A Structured and Organized security assessment, a crucial component of
    Risk Assessment for Security Auditing or Penetration Test.
  - Use of hacking tools, tricks and techniques to identify vulnerability and
    ensure system security by simulating the techniques used by attackers to
    verify existence of exploitable vulnerabilities in a system's security.
  - It is done with the permission of concerned authorities.
  
  + Why Ethical Hacking is necessary
  - To uncover vulnerabilities
  - To enhance security awareness
  - To Strengthen security posture of an organization or information system
  - To prevent hackers from gaining access to information systems
    and Security breaches.
  - And to safeguard customer data.

  + Scope and Limitations of Ethical Hacking
  - The crucial compoment in:
  - Risk Assessment
  - Auditing
  - Counter fraud
  - Information System Security Best Practices
  - defines the coverage of needed to identify risk
  - Highlight remedial actions and resolves vulnerabilities.

  - Unless organization knows what they want from the risk assessment,
  - Less experience may be gained from hiring external pentester
  - Ethical hackers can only help organizations to understand their security
    posture. It is the duty of the organization to place the right safeguard
    on the network.

  + Skills of an Ethical Hacker
  |- Technical Skills
   - In depth knowledge of Operating Systems (Linux/Unix, Windows, MacOS)
   - Networking concepts, technologies and related hardware/software
   - Computer expert and Knowledge about security related issues
   - "High Technical" knowledge for launching sophisticated attacks.
  
  |- Non-Technical Skills
   - Learnability and adaption to new technologies
   - Strong work ethics and problem solving and communication skills
   - awareness of standards and laws

--[ Information Security Controls
Information is the greatest asset of an organization. It must be secured with various policies, creating awareness, employing security mechanisms or by other means.

- The basic security concept critical to information on the internet;
- Confidentiality, Integrity and Availability
- The concept related to accessing the information is Authentication, Authorization and Non-Repudiation
- Information Security Control prevents unwanted events and reduces risk to an information assets.

** Information Assurance (IA)
The Assurance that the integrity, availability, confidentiality and authenticity of information and information systems is protected during the usage, processing, storage and transmission of information.

Using physical, technical and administrative controls, Information Assurance and Risk Management (IRM) ensures that only authorized personnel access and use information.

Some process that help in achieving information assurance;
- Develop local policy, process and guidance
- Design network and user authentication strategies
- Identifying network vulnerabilities and threats
- Identifying problem and resource requirements
- Creating plans for identified resources requirements
- Applying apropriate IA controls
- Performing certification and accreditation
- Providing IA training

** Defense-in-Depth
Security stategy in which several protection layers are placed throughout an information system
And it prevents direct attacks against the system and its data. A break in one layer leads the attacker to the next layer.

It gives administrators and engineers times to deploy new or updated counter measures to prevent the recurrence of the intrusion.

* Defense-in-Depth Layers
^
|
| Policies, Proceedures and Awarenes
| Physical
| Perimeter
| Internal Network
| Host
| Application
| Data
+--------------------------------------->

** Risk
The degree of uncertainty that an adverse effect may cause damage to the system or its resources under specified conditions.

- Probability of occurrence of a threat
- Damage, cause loss or negative impacts
- On the organization
- Either from internal or external liabilities

The likelihood that an event will occur and the impact the event might have on a IT assets.

Relation between Risk, Threats, Vulnerabilities and Impact
  RISK = Threats * Vulnerabilities * Impact

Impact of an event on information asset to the stakeholders
  RISK = Threat * Vulnerability * Asset Value 

* Factors of Risk
- The probability of the occurrence of adverse event
- The consequence of the advers event

* Risk Level
The assessment of the resulted impact on the network. Risks are categorized into different levels according to their estimated impact on the system.
  Level of Risk = Consequence * Likelihood

- Extreme/High
Serious or Imminent danger
Requires immediate measures to combact
Identify and impose control to reduce the risk to a reasonable low level.

- Medium
Moderate Danger
Immediate action not required but action should be implemented quickly
Implement control to reduce the risk to a reasonable low level.

- Low levels
Negligible danger
Take prevent measurs to mitigate the effects of risk.

> Control measures may limit the level of risk but do not always eliminate them completely.

* Risk Matrix 
Scales the risk occurrence along with its impact. It is the graphical representation of risk matrix is used to visualize and compare risks.
 Risk Matrix:
      Likelihood | Consequence
Scaling the risk by considering the probalility, likelihood and consequences or impact.
_________________________________________________________________
| Probability |  Consequences					 |
-----------------------------------------------------------------|
                Insignificant | Minor | Moderate | Major | Severe|
             L
             i
             k
             e
             l
             i
             h
             o
             o
             d
|_________________________________________________________________|

* Risk Management 
The process reducing and maintaining risk at an acceptable level by means of will-defined and actively employed security progam.

* Phases of Risk Management
- Risk Identification: Identify sources, causes, impact and other details of internal and external risk affecting the security of the organization.

- Risk Assessment: Assesses the organization's risk and provide and estimates of likelihood and impact of the risk.

- Risk Treatment: Selects and implements controls for the identified risks.

- Risk Tracking & Review: Ensures apropriate controls are implemented to handle known risks and calculates the chances of new risks occuring. And further evaluates the performance of the implemented management of risk strategies.

** Cyber Threat Intelligence (CTI)
The collection and analysis of information about threats and adversaries and the drawing of patterns that provide the ability to make knowledgeable decisions for preparedness, prevention, and response actions against various cyber-attacks.

CTI helps the organization to identify and mitigate various business risks by converting unknown threats into known threats; it helps in implementing various advanced and proactive defense strategies.

* Types of Threat Intelligence
- Strategic
Higher level information on changing risks. Consumed by higher-level executives and managements.

- Tactical
Information of attackers TTPs. Consumed by IT service, SOC managers and administration.

- Operational
Information on a specific incoming attack. Consumed by security managers and network defenders.

- Technical
Information on specific indicators of compromises (IoCs) and consumed by SOC staff and IR (Incident Response) team.

** Threat Modeling
The risk assessment approach for analyzing the security of an application by capturing, organizing and analyzing all the information that affects the security of an application. It involves;
- Understanding the adversary's perspective
- Characterizing the security of the system and
- Determining threats.

* Threat Modeling Process
Series of steps followed to identify weakness related to an application.

01- Identify Security Objectives: determines the effort needed for the subsequent steps that follow.

02- Application Overview: Identify the components, data flow and trust boundaries

03- Decompose the Application: Helps find more relevant and detailed threats.

04- Identify Threats: Identify threats relevant to the control scenario and context using the information obtained in step 2 and 3.

05- Identify Vulnerabilities: Identify weakness related to the threat found using vulnerability categories.

** Incident Management
A set of predefined processes to identify, analyze and resolve security incidents to restore normal service operations as quickly as possible and prevent future recurrence of the incident.

Incident management include the following:
- Vulnerability analysis
- Artifacts analysis
- security awareness training
- Intrusion detection (Alerts)
- Public and Technology monitoring
-* Incident Handling
 - Triage
 - Reporting and Detection
 - Incident Response
 - Analysis
- Other incident management services.

Incident management is designed to:
- Improve service quality
- Resolve problems proactively
- Increase staff effeciency and productivity
- Meet service availability requirements
- Improve user and customer satisfaction
- Assist in handling future incidents

> Conducting training sessions to spread awareness among users is an important part of indident management.

* Incident Handling and Response
Incident Response is one of the functions performed in incident handling. In turn, incident handling is one of the services provided as part of incident management.
> [ Incident Response<-Incident Handling<-Incident Management Services ]

--[ Information Security Laws and Conducts